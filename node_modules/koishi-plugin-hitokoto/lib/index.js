"use strict";var m=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var g=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),l=(n,t)=>{for(var e in t)m(n,e,{get:t[e],enumerable:!0})},v=(n,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of _(t))!b.call(n,r)&&r!==e&&m(n,r,{get:()=>t[r],enumerable:!(o=x(t,r))||o.enumerable});return n};var C=n=>v(m({},"__esModule",{value:!0}),n);var d=g((I,w)=>{w.exports={commands:{hitokoto:{description:"Random Hitokoto",usage:`Get a random Chinese sentence from hitokoto.cn.
`,example:`hitokoto        Get a random sentence
hitokoto -l 2   Get a random sentence with at least 2 characters
`,options:{type:'Specify the type of Hitokoto sentences. If you want to specify multiple types, you can use comma "," to separate different type names. Enter "hitokoto.types" to check available types.',"min-length":"Specify the minimum length of Hitokoto sentences.","max-length":"Specify the minimum length of Hitokoto sentences."},messages:{invalid_type:"The specified type {0} does not exist. Please enter hitokoto.types to check available types.",min_length_gt_max_length:"The minimum length cannot be greater than the maximum length.",service_unavailable:"Service is not available at this moment, please try again later",unknown_error:`An unknown error occurred. Please try again.
{message}`,timeout:"Request timed out. Please try again later.",format:`"{hitokoto}"
\\t\\t\\t\\t{from}, {from_who}`}},"hitokoto.types":{description:"List of types available in Hitokoto",messages:{list:`You can specify one or more of the following types, using commas "," to separate them:
{0}`}}}}});var h=g((O,P)=>{P.exports={commands:{hitokoto:{description:"\u968F\u673A\u4E00\u8A00",usage:`\u4ECE\u4E00\u8A00\u7F51 (hitokoto.cn) \u83B7\u53D6\u968F\u673A\u7684\u4E00\u53E5\u8BDD\u3002
`,example:`hitokoto        \u83B7\u53D6\u968F\u673A\u7684\u4E00\u53E5\u8BDD
hitokoto -l 2   \u83B7\u53D6\u968F\u673A\u7684\u4E00\u53E5\u8BDD\uFF0C\u957F\u5EA6\u81F3\u5C11\u4E3A 2 \u4E2A\u5B57\u7B26
`,options:{type:"\u6307\u5B9A\u4E00\u8A00\u7684\u7C7B\u578B\uFF0C\u6307\u5B9A\u591A\u4E2A\u7C7B\u578B\u65F6\u4F7F\u7528\u82F1\u6587\u9017\u53F7(,)\u5206\u5272\uFF0C\u8F93\u5165 hitokoto.types \u67E5\u770B\u6240\u6709\u53EF\u7528\u7C7B\u578B\u3002","min-length":"\u6307\u5B9A\u4E00\u8A00\u7684\u6700\u5C0F\u957F\u5EA6\u3002","max-length":"\u6307\u5B9A\u4E00\u8A00\u7684\u6700\u5927\u957F\u5EA6\u3002"},messages:{invalid_type:"\u6307\u5B9A\u7684\u4E00\u8A00\u7C7B\u578B {0} \u4E0D\u5B58\u5728\uFF0C\u8BF7\u8F93\u5165 hitokoto.types \u67E5\u770B\u6240\u6709\u53EF\u7528\u7C7B\u578B\u3002",min_length_gt_max_length:"\u6700\u5C0F\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E\u6700\u5927\u957F\u5EA6\u3002",service_unavailable:"\u5F53\u524D\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5\u3002",request_error:`\u8BF7\u6C42\u51FA\u9519\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5\u3002
{0}`,unknown_error:`\u51FA\u73B0\u672A\u77E5\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5\u3002
{message}`,timeout:"\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5\u3002",format:`\u300C{hitokoto}\u300D
				\u2014\u2014{from_who}\u300A{from}\u300B`}},"hitokoto.types":{description:"\u4E00\u8A00\u7C7B\u578B\u5217\u8868",messages:{list:`\u4F60\u53EF\u4EE5\u6307\u5B9A\u4EE5\u4E0B\u7684\u4E00\u4E2A\u6216\u591A\u4E2A\u7C7B\u578B\uFF0C\u4F7F\u7528\u82F1\u6587\u9017\u53F7(,)\u5206\u5272\uFF1A
{0}`}}}}});var R={};l(R,{Config:()=>y,HitokotoApi:()=>s,apply:()=>U,inject:()=>H,name:()=>j});module.exports=C(R);var f=require("koishi"),s=class extends f.Service{_apiUrl;config;constructor(t,e){super(t,"hitokoto",!0),this.config=e,this._apiUrl=this.config.sentences?"":this.config.apiUrl??"https://v1.hitokoto.cn/"}async getHitokoto(t){let e=this.ctx.get("sentences"),o;return this.config.sentences&&e?o=e.getSentence(t):o=await this.ctx.http.get(this._apiUrl,{params:this.buildSearchParams(t)}),{...o,from_who:o.from_who??""}}buildSearchParams(t){let e=new URLSearchParams;return t.c&&t.c.forEach(o=>e.append("c",o)),t.min_length&&e.append("min_length",t.min_length.toString()),t.max_length&&e.append("max_length",t.max_length.toString()),e}get types(){return{a:"\u52A8\u753B",b:"\u6F2B\u753B",c:"\u6E38\u620F",d:"\u6587\u5B66",e:"\u539F\u521B",f:"\u6765\u81EA\u7F51\u7EDC",g:"\u5176\u4ED6",h:"\u5F71\u89C6",i:"\u8BD7\u8BCD",j:"\u7F51\u6613\u4E91",k:"\u54F2\u5B66",l:"\u6296\u673A\u7075"}}};var c={};l(c,{apply:()=>S,inject:()=>L});var u=require("koishi"),L=["hitokoto"];async function S(n,t={}){n.command("hitokoto").alias("\u4E00\u8A00").option("type","-t <type:string>").option("minLength","-l <length:int>").option("maxLength","-L <length:int>").before(async({options:e,session:o})=>{if(e?.minLength&&e?.maxLength&&e.minLength>e.maxLength)return o?.text(".min_length_gt_max_length");if(typeof e?.type>"u")return;let r=e?.type?.split(",");if(r.length<=0||!r.every(a=>a))return o?.text(".invalid_type",[e.type])}).action(async({options:e,session:o})=>{let r={c:e?.type?.split(",")??t.defaultTypes,min_length:e?.minLength??t.minLength,max_length:e?.maxLength??t.maxLength};try{let a=await n.hitokoto.getHitokoto(r);return o?.text(".format",a)}catch(a){let p=a;return/ETIMEOUT/.test(p.message)?o?.text(".timeout"):u.Quester.isAxiosError(a)?o?.text(".request_error",[a.status]):o?.text(".unknown_error",p)}}),n.command("hitokoto.types").action(async({session:e})=>e?.text(".list",[Object.entries(n.hitokoto.types).map(([o,r])=>`${o} - ${r}`).join(`
`)]))}var i=require("koishi"),y=i.Schema.intersect([i.Schema.object({sentences:i.Schema.boolean().description("\u662F\u5426\u4F7F\u7528\u672C\u5730\u4E00\u8A00\u8BED\u6599\u5E93(\u9700\u8981\u5B89\u88C5 sentences \u670D\u52A1)").default(!1)}),i.Schema.union([i.Schema.object({sentences:i.Schema.const(!1),apiUrl:i.Schema.string().description("\u83B7\u53D6\u4E00\u8A00\u7684 API \u5730\u5740").default("https://v1.hitokoto.cn")}),i.Schema.object({})]),i.Schema.object({minLength:i.Schema.number().description("\u4E00\u8A00\u7684\u6700\u5C0F\u957F\u5EA6"),maxLength:i.Schema.number().description("\u4E00\u8A00\u7684\u6700\u5927\u957F\u5EA6"),defaultTypes:i.Schema.array(i.Schema.string()).description("\u9ED8\u8BA4\u4E00\u8A00\u7C7B\u522B")})]);var k={en:d(),zh:h(),"zh-cn":h()};var H={optional:["sentences"]},j="hitokoto";async function U(n,t={}){Object.entries(k).forEach(([e,o])=>n.i18n.define(e,o)),n.plugin(s,t),n.plugin(c,t)}0&&(module.exports={Config,HitokotoApi,apply,inject,name});
