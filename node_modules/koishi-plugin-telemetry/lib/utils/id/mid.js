"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getMachineId = void 0;
const node_crypto_1 = require("node:crypto");
const cmid_1 = require("./cmid");
const menv_1 = require("./menv");
const getMachineId = async (ctx) => {
    const l = ctx.logger('telemetry/utils/id/mid');
    const cmid = await (0, cmid_1.getCoreMachineId)(ctx);
    const menv = await (0, menv_1.getMachineEnv)(ctx);
    const rawMId = `${cmid}\n${menv}`;
    l.debug(`raw mid: ${rawMId}`);
    const mid = (0, node_crypto_1.createHash)('sha256').update(rawMId).digest('hex');
    l.debug(`mid: ${mid}`);
    return {
        cmid,
        menv,
        mid,
    };
};
exports.getMachineId = getMachineId;
